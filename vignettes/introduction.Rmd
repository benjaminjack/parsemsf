---
title: "Introduction to ParseMSF"
author: "Benjamin R. Jack"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Introduction to ParseMSF}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---


## Loading peptide information from a Thermo MSF

The ParseMSF package provides several functions for inspecting Thermo MSF files. The most useful of these functions is `make_area_table`, which constructs a data frame containing all peptides and their corresponding peak areas. This data frame also includes the protein (`protein_desc`) for each peptide.

```{r}
library(parsemsf)

# Replace `parsemsf_example("test_db.msf")` with the path to a Thermo MSF file
area_table <- make_area_table(parsemsf_example("test_db.msf"))
knitr::kable(head(area_table))
```

See the documentation for `make_area_table` for a description of each column.

## Estimating protein abundances

The peak area information stored in one or more Thermo MSF files can be used to estimate protein abundances. The `combine_tech_reps` function estimates these abundances across one or more technical replicates. Technical replicates are different mass spec injections of the same biological sample. The `combine_tech_reps` function will produce more accurate protein abundance estimates if it is provided with multiple technical replicates.

```{r}
# Replace `parsemsf_example("test_db.msf")` with the path to a Thermo MSF file
abundances <- combine_tech_reps(c(parsemsf_example("test_db.msf"), 
                                  parsemsf_example("test_db2.msf")))

knitr::kable(head(abundances))
```

Abundances are estimated by taking the top three most abundant peptides by area, and averaging them together (`area_mean`) [reference]. If provided multiple technical replicates, `combine_tech_reps` will, by default, estimate protein abundances by matching peptides across technical replicates. That is, it will only average areas from peptides that are present in both technical replicates. The number unique peptides used to estimate the protein abundances are given by `peps_per_tech_rep`.

Protein abundances can also be estimated from a single Thermo MSF File.

```{r}
# Replace `parsemsf_example("test_db.msf")` with the path to a Thermo MSF file
abundances <- combine_tech_reps(parsemsf_example("test_db.msf"))

knitr::kable(head(abundances))
```

## Inspecting distribution of peptides within a protein

The ParseMSF package includes a function for inspecting the distribution of peptides within a single protein. The `map_peptides` function produces a data frame of peptides with their respective locations within the protein sequence.

```{r}
peptide_locs <- map_peptides(parsemsf_example("test_db.msf"))

# Select columns with start and end locations
peptide_locs <- peptide_locs[c("peptide_id", "protein_desc", 
                               "peptide_sequence", "start", "end")]

knitr::kable(head(peptide_locs))
```

We can plot these peptide locations with the ggplot2 package.

```{r}



```

## Figures

The figure sizes have been customised so that you can easily put two images side-by-side. 

```{r, fig.show='hold'}
plot(1:10)
plot(10:1)
```

You can enable figure captions by `fig_caption: yes` in YAML:

    output:
      rmarkdown::html_vignette:
        fig_caption: yes

Then you can use the chunk option `fig.cap = "Your figure caption."` in **knitr**.

## More Examples

You can write math expressions, e.g. $Y = X\beta + \epsilon$, footnotes^[A footnote here.], and tables, e.g. using `knitr::kable()`.

```{r, echo=FALSE, results='asis'}
knitr::kable(head(mtcars, 10))
```

Also a quote using `>`:

> "He who gives up [code] safety for [code] speed deserves neither."
([via](https://twitter.com/hadleywickham/status/504368538874703872))
